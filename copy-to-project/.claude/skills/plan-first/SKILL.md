---
name: plan-first
description: Сначала короткий план, потом правки. План ОБЯЗАН быть сохранён в файл.
hooks:
  onComplete: |
    if [ ! -f "docs/notes/plan-*.md" ] && [ ! -f "PLAN.md" ]; then
      echo "WARNING: План НЕ сохранен в файл!"
    fi
---

Перед любыми нетривиальными изменениями ты ОБЯЗАН составить план.

## КРИТИЧЕСКОЕ ПРАВИЛО

**План ОБЯЗАН быть сохранён в ФАЙЛ**, не только в памяти разговора!

Предпочтительно: `docs/notes/plan-YYYYMMDD-<topic>.md`
Альтернатива: `PLAN.md` в корне проекта

## Когда требуется план

- Изменение кода (не только docs)
- Затрагивается более 2 файлов
- Меняется логика, правила или поведение
- Задача не является очевидной правкой

## Формат плана

Создай файл `docs/notes/plan-YYYYMMDD-<topic>.md`:

```markdown
# План: <название>

## Цель
<1-2 предложения: что именно меняем и зачем>

## Границы
- Затрагиваемые файлы/модули: ...
- Не трогать: ...

## Риски и неизвестные
1. ...
2. ...
3. ...

## Шаги
1. <небольшой, проверяемый шаг>
2. ...
3. ...

## Верификация
<конкретная команда, предпочтительно `make check`>
```

## Ограничения

- План НЕ заменяет архитектурный дизайн
- План НЕ является тест-планом (см. [`qa-gatekeeper`](../qa-gatekeeper/SKILL.md))
- План должен быть коротким и прикладным, без абстракций
- 6–12 шагов максимум

## ЗАПРЕЩЕНО

- Держать план только в памяти разговора
- Начинать правки без сохранённого плана
- Игнорировать предупреждения hook'а о несохранённом плане
